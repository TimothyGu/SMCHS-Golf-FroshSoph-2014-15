<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <link rel="stylesheet" href="style.css">
  <title>Timothy’s Golf Stats</title>
</head>
<body>
  <div class="container">
    <h1>Timothy’s Golf Stats</h1>
    <div role="tabpanel">
    <ul class="nav nav-tabs" id="navTab">
      <li role="presentation" class="active">
        <a href="#main" data-toggle="tab">Over Par</a>
      </li>
      <li role="presentation">
        <a href="#avg" data-toggle="tab">Moving Average</a>
      </li>
    </ul>
    <div class="tab-content">
      <div role="tabpanel" class="tab-pane active" id="main">
        <canvas id="mainChart"></canvas>
        <button class="btn btn-default center-block" id="clear">
          Clear
        </button>
      </div>
    </div>
    </div>
  </div>

  <footer>
    Made with ❤ by Timothy Gu. Licensed under the MIT license.<br>
    <img src="SM.svg" alt="Santa Margarita Catholic High School" width="50px">
  </footer>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js"></script>
  <script src="data.js"></script>
  <script src="average.js"></script>
  <script src="colors.js"></script>
  <script src="chart.js"></script>
  <script>
    addColors(origDatasets)
    var chart = makeChart('mainChart', origDatasets)
    var state = 'main'
    $('#navTab a[href="#avg"]').click(function (e) {
      if (state === 'avg') return
      var $this = $(this)
      $this.addClass('avg')
      state = 'avg'
      movingAverage(chart.datasets)
      chart.update()
    })
    $('#navTab a[href="#main"]').click(function (e) {
      if (state === 'main') return
      var $e = $(this)
      $e.removeClass('avg')
      state = 'main'
      revertToOrig(chart.datasets)
      chart.update()
    })

    var blank = '#eee'

    var $legend = $('#legend')
    $legend.children().each(function (index) {
      var $this = $(this)
      $this.click(function () {
        if ($legend.hasClass('selected')) {
          toggleColor(index)
          chart.update()
          return
        }
        for (var i = 0; i < chart.datasets.length; i ++) {
          if (i === index) {
            chart.datasets[i].strokeColor = colors[i]
          } else {
            chart.datasets[i].strokeColor = blank
          }
        }
        $legend.addClass('selected')
        chart.update()
      })
      // $this.mouseenter(toggleColor.bind(null, index))
      // $this.mouseleave(toggleColor.bind(null, index))
    })

    function toggleColor (i) {
      var data = chart.datasets[i]
      if (data.strokeColor === blank) {
        data.strokeColor = colors[i]
      } else {
        data.strokeColor = blank
      }
    }

    $('#clear').click(function () {
      addColors(chart.datasets)
      $legend.removeClass('selected')
      chart.update()
    })
  </script>
</body>
</html>
